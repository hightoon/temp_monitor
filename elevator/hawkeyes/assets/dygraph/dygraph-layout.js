DygraphLayout=function(b){this.dygraph_=b;this.datasets=[];this.annotations=[];this.yTicks_=this.xTicks_=this.yAxes_=null};DygraphLayout.prototype.attr_=function(b){return this.dygraph_.attr_(b)};DygraphLayout.prototype.addDataset=function(b,a){this.datasets[b]=a};
DygraphLayout.prototype.setAnnotations=function(b){this.annotations=[];for(var a=this.attr_("xValueParser")||function(a){return a},c=0;c<b.length;c++){var d={};if(!b[c].xval&&!b[c].x){this.dygraph_.error("Annotations must have an 'x' property");break}if(b[c].icon&&(!b[c].hasOwnProperty("width")||!b[c].hasOwnProperty("height"))){this.dygraph_.error("Must set width and height when setting annotation.icon property");break}Dygraph.update(d,b[c]);d.xval||(d.xval=a(d.x));this.annotations.push(d)}};
DygraphLayout.prototype.setXTicks=function(b){this.xTicks_=b};DygraphLayout.prototype.setYAxes=function(b){this.yAxes_=b};DygraphLayout.prototype.setDateWindow=function(b){this.dateWindow_=b};DygraphLayout.prototype.evaluate=function(){this._evaluateLimits();this._evaluateLineCharts();this._evaluateLineTicks();this._evaluateAnnotations()};
DygraphLayout.prototype._evaluateLimits=function(){this.minxval=this.maxxval=null;if(this.dateWindow_)this.minxval=this.dateWindow_[0],this.maxxval=this.dateWindow_[1];else for(var b in this.datasets)if(this.datasets.hasOwnProperty(b)){var a=this.datasets[b];if(1<a.length){var c=a[0][0];if(!this.minxval||c<this.minxval)this.minxval=c;a=a[a.length-1][0];if(!this.maxxval||a>this.maxxval)this.maxxval=a}}this.xrange=this.maxxval-this.minxval;this.xscale=0!=this.xrange?1/this.xrange:1;for(b=0;b<this.yAxes_.length;b++)a=
this.yAxes_[b],a.minyval=a.computedValueRange[0],a.maxyval=a.computedValueRange[1],a.yrange=a.maxyval-a.minyval,a.yscale=0!=a.yrange?1/a.yrange:1,a.g.attr_("logscale")&&(a.ylogrange=Dygraph.log10(a.maxyval)-Dygraph.log10(a.minyval),a.ylogscale=0!=a.ylogrange?1/a.ylogrange:1,isFinite(a.ylogrange)&&!isNaN(a.ylogrange)||a.g.error("axis "+b+" of graph at "+a.g+" can't be displayed in log scale for range ["+a.minyval+" - "+a.maxyval+"]"))};
DygraphLayout.prototype._evaluateLineCharts=function(){this.points=[];for(var b in this.datasets)if(this.datasets.hasOwnProperty(b))for(var a=this.datasets[b],c=this.dygraph_.axisPropertiesForSeries(b),d=0;d<a.length;d++){var e=a[d],f;f=c.logscale?1-(Dygraph.log10(parseFloat(e[1]))-Dygraph.log10(c.minyval))*c.ylogscale:1-(parseFloat(e[1])-c.minyval)*c.yscale;e={x:(parseFloat(e[0])-this.minxval)*this.xscale,y:f,xval:parseFloat(e[0]),yval:parseFloat(e[1]),name:b};this.points.push(e)}};
DygraphLayout.prototype._evaluateLineTicks=function(){this.xticks=[];for(var b=0;b<this.xTicks_.length;b++){var a=this.xTicks_[b],c=a.label,a=this.xscale*(a.v-this.minxval);0<=a&&1>=a&&this.xticks.push([a,c])}this.yticks=[];for(b=0;b<this.yAxes_.length;b++)for(var d=this.yAxes_[b],e=0;e<d.ticks.length;e++)a=d.ticks[e],c=a.label,a=this.dygraph_.toPercentYCoord(a.v,b),0<=a&&1>=a&&this.yticks.push([b,a,c])};
DygraphLayout.prototype.evaluateWithError=function(){this.evaluate();if(this.attr_("errorBars")||this.attr_("customBars")){var b=0,a;for(a in this.datasets)if(this.datasets.hasOwnProperty(a))for(var c=0,d=this.datasets[a],c=0;c<d.length;c++,b++){var e=d[c],f=parseFloat(e[0]),g=parseFloat(e[1]);f==this.points[b].xval&&g==this.points[b].yval&&(this.points[b].errorMinus=parseFloat(e[2]),this.points[b].errorPlus=parseFloat(e[3]))}}};
DygraphLayout.prototype._evaluateAnnotations=function(){for(var b={},a=0;a<this.annotations.length;a++){var c=this.annotations[a];b[c.xval+","+c.series]=c}this.annotated_points=[];for(a=0;a<this.points.length;a++){var c=this.points[a],d=c.xval+","+c.name;d in b&&(c.annotation=b[d],this.annotated_points.push(c))}};DygraphLayout.prototype.removeAllDatasets=function(){delete this.datasets;this.datasets=[]};
DygraphLayout.prototype.unstackPointAtIndex=function(b){var a=this.points[b],c={},d;for(d in a)c[d]=a[d];if(!this.attr_("stackedGraph"))return c;for(d=b+1;d<this.points.length;d++)if(this.points[d].xval==a.xval){c.yval-=this.points[d].yval;break}return c};